<!DOCTYPE HTML>
<html lang="de" class="coal" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Specification - Ordinal Theory Handbook</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../language-picker.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "coal" : "coal";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('coal')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../introduction.html">Einführung</a></li><li class="chapter-item expanded "><a href="../overview.html"><strong aria-hidden="true">1.</strong> Übersicht</a></li><li class="chapter-item expanded "><a href="../digital-artifacts.html"><strong aria-hidden="true">2.</strong> Digitale Artefakte</a></li><li class="chapter-item expanded "><a href="../inscriptions.html"><strong aria-hidden="true">3.</strong> Inscriptions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../inscriptions/delegate.html"><strong aria-hidden="true">3.1.</strong> Delegate</a></li><li class="chapter-item expanded "><a href="../inscriptions/metadata.html"><strong aria-hidden="true">3.2.</strong> Metadata</a></li><li class="chapter-item expanded "><a href="../inscriptions/pointer.html"><strong aria-hidden="true">3.3.</strong> Pointer</a></li><li class="chapter-item expanded "><a href="../inscriptions/provenance.html"><strong aria-hidden="true">3.4.</strong> Provenance</a></li><li class="chapter-item expanded "><a href="../inscriptions/recursion.html"><strong aria-hidden="true">3.5.</strong> Rekursion</a></li><li class="chapter-item expanded "><a href="../inscriptions/rendering.html"><strong aria-hidden="true">3.6.</strong> Rendering</a></li></ol></li><li class="chapter-item expanded "><a href="../runes.html"><strong aria-hidden="true">4.</strong> Runes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../runes/specification.html" class="active"><strong aria-hidden="true">4.1.</strong> Specification</a></li></ol></li><li class="chapter-item expanded "><a href="../faq.html"><strong aria-hidden="true">5.</strong> Häufig gestellte Fragen</a></li><li class="chapter-item expanded "><a href="../contributing.html"><strong aria-hidden="true">6.</strong> Beitragen</a></li><li class="chapter-item expanded "><a href="../donate.html"><strong aria-hidden="true">7.</strong> Spenden</a></li><li class="chapter-item expanded "><a href="../guides.html"><strong aria-hidden="true">8.</strong> Anleitungen</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../guides/explorer.html"><strong aria-hidden="true">8.1.</strong> Explorer</a></li><li class="chapter-item expanded "><a href="../guides/wallet.html"><strong aria-hidden="true">8.2.</strong> Wallet</a></li><li class="chapter-item expanded "><a href="../guides/batch-inscribing.html"><strong aria-hidden="true">8.3.</strong> Batch Inscribing</a></li><li class="chapter-item expanded "><a href="../guides/collecting.html"><strong aria-hidden="true">8.4.</strong> Sammeln</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../guides/collecting/sparrow-wallet.html"><strong aria-hidden="true">8.4.1.</strong> Sparrow Wallet</a></li></ol></li><li class="chapter-item expanded "><a href="../guides/moderation.html"><strong aria-hidden="true">8.5.</strong> Moderation</a></li><li class="chapter-item expanded "><a href="../guides/reindexing.html"><strong aria-hidden="true">8.6.</strong> Erneutes Indizieren</a></li><li class="chapter-item expanded "><a href="../guides/sat-hunting.html"><strong aria-hidden="true">8.7.</strong> Sat-Suche</a></li><li class="chapter-item expanded "><a href="../guides/settings.html"><strong aria-hidden="true">8.8.</strong> Settings</a></li><li class="chapter-item expanded "><a href="../guides/teleburning.html"><strong aria-hidden="true">8.9.</strong> Teleburning</a></li><li class="chapter-item expanded "><a href="../guides/testing.html"><strong aria-hidden="true">8.10.</strong> Testen</a></li></ol></li><li class="chapter-item expanded "><a href="../bounties.html"><strong aria-hidden="true">9.</strong> Bounties</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../bounty/0.html"><strong aria-hidden="true">9.1.</strong> Bounty 0: 100.000 sats beansprucht!</a></li><li class="chapter-item expanded "><a href="../bounty/1.html"><strong aria-hidden="true">9.2.</strong> Bounty 1: 200.000 sats beansprucht!</a></li><li class="chapter-item expanded "><a href="../bounty/2.html"><strong aria-hidden="true">9.3.</strong> Bounty 2: 300.000 sats beansprucht!</a></li><li class="chapter-item expanded "><a href="../bounty/3.html"><strong aria-hidden="true">9.4.</strong> Bounty 3: 400.000 sats</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Ordinal Theory Handbook</h1>

                    <div class="right-buttons">
                        <button id="language-toggle" class="icon-button" type="button"
                                title="Change language" aria-label="Change language"
                                aria-haspopup="true" aria-expanded="false"
                                aria-controls="language-list">
                            <i class="fa fa-globe"></i>
                        </button>
                        <ul id="language-list" class="theme-popup" aria-label="Languages" role="menu">
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="en">English</a>
                          </button></li>
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="de">Deutsch</a>
                          </button></li>
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="fr">Français</a>
                          </button></li>
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="es">Español</a>
                          </button></li>
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="pt">Português</a>
                          </button></li>
                           <li role="none"><button role="menuitem" class="theme">
                              <a id="ru">Русский</a>
                          </button></li>
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="zh">中文版</a>
                          </button></li>
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="ja">日本語版</a>
                          </button></li>
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="ko">한국어</a>
                          </button></li>
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="fil">Filipino</a>
                          </button></li>
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="ar">العربية</a>
                          </button></li>
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="hi">हिंदी</a>
                          </button></li>
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="it">Italiano</a>
                          </button></li>
                        </ul>

                        <script>
                          let langToggle = document.getElementById("language-toggle");
                          let langList = document.getElementById("language-list");
                          langToggle.addEventListener("click", (event) => {
                              langList.style.display = langList.style.display == "block" ? "none" : "block";
                          });
                          let selectedLang = document.getElementById("de");
                          if (selectedLang) {
                              selectedLang.parentNode.classList.add("theme-selected");
                          }

                          // The path to the root, taking the current
                          // language into account.
                          let full_path_to_root = "../../";
                          // The page path (mdbook only gives us
                          // access to the path to the Markdown file).
                          let path = "runes/specification.md".replace(/\.md$/, ".html");
                          for (let lang of langList.querySelectorAll("a")) {
                              if (lang.id == "en") {
                                  lang.href = `${full_path_to_root}${path}`;
                              } else {
                                  lang.href = `${full_path_to_root}${lang.id}/${path}`;
                              }
                          }
                        </script>

                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/ordinals/ord" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="runes-does-not-have-a-specification"><a class="header" href="#runes-does-not-have-a-specification">Runes Does Not Have a Specification</a></h1>
<p>The Runes reference implementation, <code>ord</code>, is the normative specification of the Runes protocol.</p>
<p>Nothing you read here or elsewhere, aside from the code of <code>ord</code>, is a specification. This prose description of the runes protocol is provided as a guide to the behavior of <code>ord</code>, and the code of <code>ord</code> itself should always be consulted to confirm the correctness of any prose description.</p>
<p>If, due to a bug in <code>ord</code>, this document diverges from the actual behavior of <code>ord</code> and it is impractically disruptive to change <code>ord</code>'s behavior, this document will be amended to agree with <code>ord</code>'s actual behavior.</p>
<p>Users of alternative implementations do so at their own risk, and services wishing to integrate Runes are strongly encouraged to use <code>ord</code> itself to make Runes transactions, and to determine the state of runes, mints, and balances.</p>
<h2 id="runestones"><a class="header" href="#runestones">Runestones</a></h2>
<p>Rune protocol messages are termed "runestones".</p>
<p>The Runes protocol activates on block 840,000. Runestones in earlier blocks are ignored.</p>
<p>Abstractly, runestones contain the following fields:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Runestone {
  edicts: Vec&lt;Edict&gt;,
  etching: Option&lt;Etching&gt;,
  mint: Option&lt;RuneId&gt;,
  pointer: Option&lt;u32&gt;,
}
<span class="boring">}</span></code></pre></pre>
<p>Runes are created by etchings:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Etching {
  divisibility: Option&lt;u8&gt;,
  premine: Option&lt;u128&gt;,
  rune: Option&lt;Rune&gt;,
  spacers: Option&lt;u32&gt;,
  symbol: Option&lt;char&gt;,
  terms: Option&lt;Terms&gt;,
}
<span class="boring">}</span></code></pre></pre>
<p>Which may contain mint terms:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Terms {
  amount: Option&lt;u128&gt;,
  cap: Option&lt;u128&gt;,
  height: (Option&lt;u64&gt;, Option&lt;u64&gt;),
  offset: (Option&lt;u64&gt;, Option&lt;u64&gt;),
}
<span class="boring">}</span></code></pre></pre>
<p>Runes are transferred by edict:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Edict {
  id: RuneId,
  amount: u128,
  output: u32,
}
<span class="boring">}</span></code></pre></pre>
<p>Rune IDs are encoded as the block height and transaction index of the transaction in which the rune was etched:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct RuneId {
  block: u64,
  tx: u32,
}
<span class="boring">}</span></code></pre></pre>
<p>Rune IDs are represented in text as <code>BLOCK:TX</code>.</p>
<p>Rune names are encoded as modified base-26 integers:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Rune(u128);
<span class="boring">}</span></code></pre></pre>
<h3 id="deciphering"><a class="header" href="#deciphering">Deciphering</a></h3>
<p>Runestones are deciphered from transactions with the following steps:</p>
<ol>
<li>
<p>Find the first transaction output whose script pubkey begins with <code>OP_RETURN OP_13</code>.</p>
</li>
<li>
<p>Concatenate all following data pushes into a payload buffer.</p>
</li>
<li>
<p>Decode a sequence 128-bit <a href="https://en.wikipedia.org/wiki/LEB128">LEB128</a> integers from the payload buffer.</p>
</li>
<li>
<p>Parse the sequence of integers into an untyped message.</p>
</li>
<li>
<p>Parse the untyped message into a runestone.</p>
</li>
</ol>
<p>Deciphering may produce a malformed runestone, termed a <a href="https://en.wikipedia.org/wiki/Cenotaph">cenotaph</a>.</p>
<h4 id="locating-the-runestone-output"><a class="header" href="#locating-the-runestone-output">Locating the Runestone Output</a></h4>
<p>Outputs are searched for the first script pubkey that beings with <code>OP_RETURN OP_13</code>. If deciphering fails, later matching outputs are not considered.</p>
<h4 id="assembling-the-payload-buffer"><a class="header" href="#assembling-the-payload-buffer">Assembling the Payload Buffer</a></h4>
<p>The payload buffer is assembled by concatenating data pushes, after <code>OP_13</code>, in the matching script pubkey.</p>
<p>Data pushes are opcodes 0 through 78 inclusive. If a non-data push opcode is encountered, i.e., any opcode equal to or greater than opcode 79, the deciphered runestone is a cenotaph with no etching, mint, or edicts.</p>
<h4 id="decoding-the-integer-sequence"><a class="header" href="#decoding-the-integer-sequence">Decoding the Integer Sequence</a></h4>
<p>A sequence of 128-bit integers are decoded from the payload as LEB128 varints.</p>
<p>LEB128 varints are encoded as sequence of bytes, each of which has the most-significant bit set, except for the last.</p>
<p>If a LEB128 varint contains more than 18 bytes, would overflow a u128, or is truncated, meaning that the end of the payload buffer is reached before encountering a byte with the continuation bit not set, the decoded runestone is a cenotaph with no etching, mint, or edicts.</p>
<h4 id="parsing-the-message"><a class="header" href="#parsing-the-message">Parsing the Message</a></h4>
<p>The integer sequence is parsed into an untyped message:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Message {
  fields: Map&lt;u128, Vec&lt;u128&gt;&gt;,
  edicts: Vec&lt;Edict&gt;,
}
<span class="boring">}</span></code></pre></pre>
<p>The integers are interpreted as a sequence of tag/value pairs, with duplicate tags appending their value to the field value.</p>
<p>If a tag with value zero is encountered, all following integers are interpreted as a series of four-integer edicts, each consisting of a rune ID block height, rune ID transaction index, amount, and output.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Edict {
  id: RuneId,
  amount: u128,
  output: u32,
}
<span class="boring">}</span></code></pre></pre>
<p>Rune ID block heights and transaction indices in edicts are delta encoded.</p>
<p>Edict rune ID decoding starts with a base block height and transaction index of zero. When decoding each rune ID, first the encoded block height delta is added to the base block height. If the block height delta is zero, the next integer is a transaction index delta. If the block height delta is greater than zero, the next integer is instead an absolute transaction index.</p>
<p>This implies that edicts must first be sorted by rune ID before being encoded in a runestone.</p>
<p>For example, to encode the following edicts:</p>
<div class="table-wrapper"><table><thead><tr><th>block</th><th>TX</th><th>amount</th><th>output</th></tr></thead><tbody>
<tr><td>10</td><td>5</td><td>5</td><td>1</td></tr>
<tr><td>50</td><td>1</td><td>25</td><td>4</td></tr>
<tr><td>10</td><td>7</td><td>1</td><td>8</td></tr>
<tr><td>10</td><td>5</td><td>10</td><td>3</td></tr>
</tbody></table>
</div>
<p>They are first sorted by block height and transaction index:</p>
<div class="table-wrapper"><table><thead><tr><th>block</th><th>TX</th><th>amount</th><th>output</th></tr></thead><tbody>
<tr><td>10</td><td>5</td><td>5</td><td>1</td></tr>
<tr><td>10</td><td>5</td><td>10</td><td>3</td></tr>
<tr><td>10</td><td>7</td><td>1</td><td>8</td></tr>
<tr><td>50</td><td>1</td><td>25</td><td>4</td></tr>
</tbody></table>
</div>
<p>And then delta encoded as:</p>
<div class="table-wrapper"><table><thead><tr><th>block delta</th><th>TX delta</th><th>amount</th><th>output</th></tr></thead><tbody>
<tr><td>10</td><td>5</td><td>5</td><td>1</td></tr>
<tr><td>0</td><td>0</td><td>10</td><td>3</td></tr>
<tr><td>0</td><td>2</td><td>1</td><td>8</td></tr>
<tr><td>40</td><td>1</td><td>25</td><td>4</td></tr>
</tbody></table>
</div>
<p>If an edict output is greater than the number of outputs of the transaction, an edict rune ID is encountered with block zero and nonzero transaction index, or a field is truncated, meaning a tag is encountered without a value, the decoded runestone is a cenotaph.</p>
<p>Note that if a cenotaph is produced here, the cenotaph is not empty, meaning that it contains the fields and edicts, which may include an etching and mint.</p>
<h4 id="parsing-the-runestone"><a class="header" href="#parsing-the-runestone">Parsing the Runestone</a></h4>
<p>The runestone:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Runestone {
  edicts: Vec&lt;Edict&gt;,
  etching: Option&lt;Etching&gt;,
  mint: Option&lt;RuneId&gt;,
  pointer: Option&lt;u32&gt;,
}
<span class="boring">}</span></code></pre></pre>
<p>Is parsed from the unsigned message using the following tags:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>enum Tag {
  Body = 0,
  Flags = 2,
  Rune = 4,
  Premine = 6,
  Cap = 8,
  Amount = 10,
  HeightStart = 12,
  HeightEnd = 14,
  OffsetStart = 16,
  OffsetEnd = 18,
  Mint = 20,
  Pointer = 22,
  Cenotaph = 126,

  Divisibility = 1,
  Spacers = 3,
  Symbol = 5,
  Nop = 127,
}
<span class="boring">}</span></code></pre></pre>
<p>Note that tags are grouped by parity, i.e., whether they are even or odd. Unrecognized odd tags are ignored. Unrecognized even tags produce a cenotaph.</p>
<p>All unused tags are reserved for use by the protocol, may be assigned at any time, and must not be used.</p>
<h5 id="body"><a class="header" href="#body">Body</a></h5>
<p>The <code>Body</code> tag marks the end of the runestone's fields, causing all following integers to be interpreted as edicts.</p>
<h5 id="flags"><a class="header" href="#flags">Flags</a></h5>
<p>The <code>Flag</code> field contains a bitmap of flags, whose position is <code>1 &lt;&lt; FLAG_VALUE</code>:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>enum Flag {
  Etching = 0,
  Terms = 1,
  Turbo = 2,
  Cenotaph = 127,
}
<span class="boring">}</span></code></pre></pre>
<p>The <code>Etching</code> flag marks this transaction as containing an etching.</p>
<p>The <code>Terms</code> flag marks this transaction's etching as having open mint terms.</p>
<p>The <code>Turbo</code> flag marks this transaction's etching as opting into future protocol changes. These protocol changes may increase light client validation costs, or just be highly degenerate.</p>
<p>The <code>Cenotaph</code> flag is unrecognized.</p>
<p>If the value of the flags field after removing recognized flags is nonzero, the runestone is a cenotaph.</p>
<h5 id="rune"><a class="header" href="#rune">Rune</a></h5>
<p>The <code>Rune</code> field contains the name of the rune being etched. If the <code>Etching</code> flag is set but the <code>Rune</code> field is omitted, a reserved rune name is allocated.</p>
<h5 id="premine"><a class="header" href="#premine">Premine</a></h5>
<p>The <code>Premine</code> field contains the amount of premined runes.</p>
<h5 id="cap"><a class="header" href="#cap">Cap</a></h5>
<p>The <code>Cap</code> field contains the allowed number of mints.</p>
<h5 id="amount"><a class="header" href="#amount">Amount</a></h5>
<p>The <code>Amount</code> field contains the amount of runes each mint transaction receives.</p>
<h5 id="heightstart-and-heightend"><a class="header" href="#heightstart-and-heightend">HeightStart and HeightEnd</a></h5>
<p>The <code>HeightStart</code> and <code>HeightEnd</code> fields contain the mint's starting and ending absolute block heights, respectively. The mint is open starting in the block with height <code>HeightStart</code>, and closes in the block with height <code>HeightEnd</code>.</p>
<h5 id="offsetstart-and-offsetend"><a class="header" href="#offsetstart-and-offsetend">OffsetStart and OffsetEnd</a></h5>
<p>The <code>OffsetStart</code> and <code>OffsetEnd</code> fields contain the mint's starting and ending block heights, relative to the block in which the etching is mined. The mint is open starting in the block with height <code>OffsetStart</code> + <code>ETCHING_HEIGHT</code>, and closes in the block with height <code>OffsetEnd</code> + <code>ETCHING_HEIGHT</code>.</p>
<h5 id="mint"><a class="header" href="#mint">Mint</a></h5>
<p>The <code>Mint</code> field contains the Rune ID of the rune to be minted in this transaction.</p>
<h5 id="pointer"><a class="header" href="#pointer">Pointer</a></h5>
<p>The <code>Pointer</code> field contains the index of the output to which runes unallocated by edicts should be transferred. If the <code>Pointer</code> field is absent, unallocated runes are transferred to the first non-<code>OP_RETURN</code> output.</p>
<h5 id="cenotaph"><a class="header" href="#cenotaph">Cenotaph</a></h5>
<p>The <code>Cenotaph</code> field is unrecognized.</p>
<h5 id="divisibility"><a class="header" href="#divisibility">Divisibility</a></h5>
<p>The <code>Divisibility</code> field, raised to the power of ten, is the number of subunits in a super unit of runes.</p>
<p>For example, the amount <code>1234</code> of different runes with divisibility 0 through 3 is displayed as follows:</p>
<div class="table-wrapper"><table><thead><tr><th>Divisibility</th><th>Display</th></tr></thead><tbody>
<tr><td>0</td><td>1234</td></tr>
<tr><td>1</td><td>123.4</td></tr>
<tr><td>2</td><td>12.34</td></tr>
<tr><td>3</td><td>1.234</td></tr>
</tbody></table>
</div>
<h5 id="spacers"><a class="header" href="#spacers">Spacers</a></h5>
<p>The <code>Spacers</code> field is a bitfield of <code>•</code> spacers that should be displayed between the letters of the rune's name.</p>
<p>The Nth field of the bitfield, starting from the least significant, determines whether or not a spacer should be displayed between the Nth and N+1th character, starting from the left of the rune's name.</p>
<p>For example, the rune name <code>AAAA</code> rendered with different spacers:</p>
<div class="table-wrapper"><table><thead><tr><th>Spacers</th><th>Display</th></tr></thead><tbody>
<tr><td>0b1</td><td>A•AAA</td></tr>
<tr><td>0b11</td><td>A•A•AA</td></tr>
<tr><td>0b10</td><td>AA•AA</td></tr>
<tr><td>0b111</td><td>A•A•A•A</td></tr>
</tbody></table>
</div>
<p>Trailing spacers are ignored.</p>
<h5 id="symbol"><a class="header" href="#symbol">Symbol</a></h5>
<p>The <code>Symbol</code> field is the Unicode codepoint of the Rune's currency symbol, which should be displayed after amounts of that rune. If a rune does not have a currency symbol, the generic currency character <code>¤</code> should be used.</p>
<p>For example, if the <code>Symbol</code> is <code>#</code> and the divisibility is 2, the amount of <code>1234</code> units should be displayed as <code>12.34 #</code>.</p>
<h5 id="nop"><a class="header" href="#nop">Nop</a></h5>
<p>The <code>Nop</code> field is unrecognized.</p>
<h4 id="cenotaphs"><a class="header" href="#cenotaphs">Cenotaphs</a></h4>
<p>Cenotaphs have the following effects:</p>
<ul>
<li>
<p>All runes input to a transaction containing a cenotaph are burned.</p>
</li>
<li>
<p>If the runestone that produced the cenotaph contained an etching, the etched rune has supply zero and is unmintable.</p>
</li>
<li>
<p>If the runestone that produced the cenotaph is a mint, the mint counts against the mint cap and the minted runes are burned.</p>
</li>
</ul>
<p>Cenotaphs may be created if a runestone contains an unrecognized even tag, an unrecognized flag, an edict with an output number greater than the number of inputs, a rune ID with block zero and nonzero transaction index, a malformed varint, a non-datapush instruction in the runestone output script pubkey, a tag without a following value, or trailing integers not part of an edict.</p>
<h4 id="executing-the-runestone"><a class="header" href="#executing-the-runestone">Executing the Runestone</a></h4>
<p>Runestones are executed in the order their transactions are included in blocks.</p>
<h5 id="etchings"><a class="header" href="#etchings">Etchings</a></h5>
<p>A runestone may contain an etching:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Etching {
  divisibility: Option&lt;u8&gt;,
  premine: Option&lt;u128&gt;,
  rune: Option&lt;Rune&gt;,
  spacers: Option&lt;u32&gt;,
  symbol: Option&lt;char&gt;,
  terms: Option&lt;Terms&gt;,
}
<span class="boring">}</span></code></pre></pre>
<p><code>rune</code> is the name of the rune to be etched, encoded as modified base-26 integer.</p>
<p>Rune names consist of the letters A through Z, with the following encoding:</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Encoding</th></tr></thead><tbody>
<tr><td>A</td><td>0</td></tr>
<tr><td>B</td><td>1</td></tr>
<tr><td>…</td><td>…</td></tr>
<tr><td>Y</td><td>24</td></tr>
<tr><td>Z</td><td>25</td></tr>
<tr><td>AA</td><td>26</td></tr>
<tr><td>AB</td><td>27</td></tr>
<tr><td>…</td><td>…</td></tr>
<tr><td>AY</td><td>50</td></tr>
<tr><td>AZ</td><td>51</td></tr>
<tr><td>BA</td><td>52</td></tr>
</tbody></table>
</div>
<p>And so on and so on.</p>
<p>Rune names <code>AAAAAAAAAAAAAAAAAAAAAAAAAAA</code> and above are reserved.</p>
<p>If <code>rune</code> is omitted a reserved rune name is allocated as follows:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn reserve(block: u64, tx: u32) -&gt; Rune {
  Rune(
    6402364363415443603228541259936211926
    + (u128::from(block) &lt;&lt; 32 | u128::from(tx))
  )
}
<span class="boring">}</span></code></pre></pre>
<p><code>6402364363415443603228541259936211926</code> corresponds to the rune name <code>AAAAAAAAAAAAAAAAAAAAAAAAAAA</code>.</p>
<p>If <code>rune</code> is present, it must be unlocked as of the block in which the etching appears.</p>
<p>Initially, all rune names of length thirteen and longer, up until the first reserved rune name, are unlocked.</p>
<p>Runes begin unlocking in block 840,000, the block in which the runes protocol activates.</p>
<p>Thereafter, every 17,500 block period, the next shortest length of rune names is continuously unlocked. So, between block 840,000 and block 857,500, the twelve-character rune names are unlocked, between block 857,500 and block 875,000 the eleven character rune names are unlocked, and so on and so on, until the one-character rune names are unlocked between block 1,032,500 and block 1,050,000. See the <code>ord</code> codebase for the precise unlocking schedule.</p>
<p>To prevent front running an etching that has been broadcast but not mined, if a non-reserved rune name is being etched, the etching transaction must contain a valid commitment to the name being etched.</p>
<p>A commitment consists of a data push of the rune name, encoded as a little-endian integer with trailing zero bytes elided, present in an input witness tapscript where the output being spent has at least six confirmations.</p>
<p>If a valid commitment is not present, the etching is ignored.</p>
<h4 id="minting"><a class="header" href="#minting">Minting</a></h4>
<p>A runestone may mint a rune by including the rune's ID in the <code>Mint</code> field.</p>
<p>If the mint is open, the mint amount is added to the unallocated runes in the transaction's inputs. These runes may be transferred using edicts, and will otherwise be transferred to the first non-<code>OP_RETURN</code> output, or the output designated by the <code>Pointer</code> field.</p>
<p>Mints may be made in any transaction after an etching, including in the same block.</p>
<h4 id="transferring"><a class="header" href="#transferring">Transferring</a></h4>
<p>Runes are transferred by edict:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Edict {
  id: RuneId,
  amount: u128,
  output: u32,
}
<span class="boring">}</span></code></pre></pre>
<p>A runestone may contain any number of edicts, which are processed in sequence.</p>
<p>Before edicts are processed, input runes, as well as minted or premined runes, if any, are unallocated.</p>
<p>Each edict decrements the unallocated balance of rune <code>id</code> and increments the balance allocated to transaction outputs of rune <code>id</code>.</p>
<p>If an edict would allocate more runes than are currently unallocated, the <code>amount</code> is reduced to the number of currently unallocated runes. In other words, the edict allocates all remaining unallocated units of rune <code>id</code>.</p>
<p>Because the ID of an etched rune is not known before it is included in a block, ID <code>0:0</code> is used to mean the rune being etched in this transaction, if any.</p>
<p>An edict with <code>amount</code> zero allocates all remaining units of rune <code>id</code>.</p>
<p>An edict with <code>output</code> equal to the number of transaction outputs allocates <code>amount</code> runes to each non-<code>OP_RETURN</code> output in order.</p>
<p>An edict with <code>amount</code> zero and <code>output</code> equal to the number of transaction outputs divides all unallocated units of rune <code>id</code> between each non-<code>OP_RETURN</code> output. If the number of unallocated runes is not divisible by the number of non-<code>OP_RETURN</code> outputs, 1 additional rune is assigned to the first <code>R</code> non-<code>OP_RETURN</code> outputs, where <code>R</code> is the remainder after dividing the balance of unallocated units of rune <code>id</code> by the number of non-<code>OP_RETURN</code> outputs.</p>
<p>If any edict in a runestone has a rune ID with <code>block</code> zero and <code>tx</code> greater than zero, or <code>output</code> greater than the number of transaction outputs, the runestone is a cenotaph.</p>
<p>Note that edicts in cenotaphs are not processed, and all input runes are burned.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../runes.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../faq.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../runes.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../faq.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
